{% load i18n static svg %}

{% get_current_language as CURRENT_LANGUAGE_CODE %}

<!DOCTYPE html>
<html lang="{{ CURRENT_LANGUAGE_CODE }}">
<head>
    {% block head %}
        {% include 'includes/icons.html' %}
        <link rel="stylesheet" href="{% static 'css/base.css' %}">
    {% endblock head %}
</head>
<body>

{% block menu %}
    <nav>
        <div class="menu">
            <div class="menu__left">
                <a href="{% url 'index' %}" class="menu__link menu__link--narrow">
                    {% svg "svg/rocket.svg" %}
                </a>
            </div>
            <div class="menu__right">
                {% if request.user.is_anonymous %}
                    <a href="{{ menu.user.login.url }}" class="menu__link">{{ menu.user.login.label }}</a>
                    <a href="{{ menu.user.register.url }}" class="menu__link">{{ menu.user.register.label }}</a>
                {% else %}
                    {% if menu.portfolio.view %}
                        <a href="{{ menu.portfolio.view.url }}" class="menu__link">{{ menu.portfolio.view.label }}</a>
                        <a href="{{ menu.portfolio.edit.url }}" class="menu__link">{{ menu.portfolio.edit.label }}</a>
                    {% else %}
                        <a href="{{ menu.portfolio.create.url }}"
                           class="menu__link">{{ menu.portfolio.create.label }}</a>
                    {% endif %}
                    <a href="{{ menu.user.edit.url }}" class="menu__link">{{ menu.user.edit.label }}</a>
                    <form class="menu__link" method="POST" action="{{ menu.user.logout.url }}">
                        {% csrf_token %}
                        <button type="submit">{{ menu.user.logout.label }}</button>
                    </form>
                {% endif %}
            </div>
        </div>
    </nav>
{% endblock menu %}

<main>
    <div class="content">
        {% block content %}{% endblock content %}
    </div>
</main>

{% for message in messages %}
    <div class="flash-message {% if message.tags %}flash-message--{{ message.tags }}{% endif %} js-flash-message">
        <p class="flash-message__text">
            {{ message }}
        </p>
        <div class="flash-message__close-button js-flash-message-close-button">
            {% svg "svg/x.svg" %}
        </div>
    </div>
{% endfor %}

<script src="{% static 'js/flash-messages.js' %}"></script>

{% if GOOGLE_ANALYTICS_TRACKING_ID %}
    <script async src="https://www.googletagmanager.com/gtag/js?id={{ GOOGLE_ANALYTICS_TRACKING_ID }}"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag("js", new Date());
        gtag("config", "{{ GOOGLE_ANALYTICS_TRACKING_ID }}");
    </script>
{% endif %}

</body>
</html>
